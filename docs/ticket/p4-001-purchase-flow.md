### 基本情報

**タイトル**: 購入フローの実装

### 概要

ユーザーが選択したプランを購入するためのフローを実装します。

### 要件

- [ ] ユーザーが選択した`Package`オブジェクトを使用して購入処理を開始する
- [ ] 購入処理中の待機状態を UI にフィードバックする
- [ ] 購入成功のハンドリングを行う
- [ ] 購入失敗・キャンセルのハンドリングを行う

### 技術仕様

**技術スタック**: React Native, RevenueCat
**ファイル**: `src/hooks/paywall/usePaywall.ts`
**API**: `Purchases.purchasePackage()`

### 実装手順

1. `usePaywall`フック内に、選択された`Package`を引数に取る購入関数を定義する。
2. 関数の内部で`Purchases.purchasePackage()`を呼び出す。
3. `try...catch`ブロックを使用して、成功と失敗のケースをハンドリングする。
   - **成功時**: `purchasePackage`は最新の`CustomerInfo`を返す。ユーザーのエンタイトルメントが有効になったことを確認し、ペイウォールを閉じるなどの画面遷移を行う。
   - **失敗時**: エラーオブジェクトをキャッチする。`error.userCancelled`プロパティなどを確認して、ユーザーによるキャンセルかどうかを判定する。
4. 購入処理中はローディングインジケーターを表示するなどして、ユーザーに待機状態であることを伝える。
5. 成功時・失敗時には適切なアラートやメッセージを表示する。

### テスト項目

- [ ] 購入ボタンをタップすると、OS の購入確認ダイアログが表示されること
- [ ] テスト購入が成功し、エンタイトルメントが有効になること
- [ ] 購入をキャンセルした場合に、アプリが正常に元の状態に戻ること
- [ ] 購入失敗時にエラーメッセージが表示されること

### 完了条件

- [ ] ユーザーがプランを購入し、プレミアム機能へのアクセス権を取得できること

### 注意事項

テストには`react-native-purchases`が提供するサンドボックス環境（TestFlight や Google Play の内部テストトラックなど）を使用する必要があります。

### 関連チケット

- P2-002-dynamic-plan-display
- P4-002-restore-flow
- P5-002-feature-guard
